<!-- Generated by SpecStory -->

# GraphQL Query Error Troubleshooting (2025-04-27 17:30:37)

_**User**_

when executing a grahpql query LLM received this erro, can you help me brainstorm about it and how to fix it I see the issue. Looking at the schema, I need to use createChoiceListItemTranslation instead of updateChoiceListItemTranslation since these translations don't exist yet. Also, the input parameter is named text but it will be stored as label in the translation. Let me add the missing German translations:



---

_**Assistant**_



---

Okay, I understand. You've correctly identified that you need to use `createChoiceListItemTranslation` for new translations and noted the `text` vs. `label` input difference.

I promise I will only propose one change at a time.

To help you structure the `createChoiceListItemTranslation` mutation correctly, I need to check its definition to see exactly what arguments it expects (like `choiceListItemId`, `languageCode`, and how the `label` field is named in the input object).

First, I'll locate the relevant mutation file.

---

<details>
            <summary>Searched codebase "choiceListItemTranslation.js" • **0** results</summary>
        
No results found
</details>

---

It seems the file search didn't complete. Let me try searching specifically within the `server/src/graphql/mutations` directory.

---

<details>
            <summary>Searched codebase "choiceListItemTranslation mutation definition" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `server/src/graphql/mutations/choiceListItemTranslation.ts` | L1-19 |
| `server/src/graphql/mutations/choiceListItem.ts` | L15-63 |
| `server/src/graphql/mutations/choiceListItemTranslation.ts` | L19-66 |
| `server/src/graphql/mutations/choiceListItemTranslation.ts` | L76-124 |
| `server/src/graphql/mutations/choiceListItem.ts` | L1-15 |
| `server/src/graphql/mutations/choiceListItemTranslation.ts` | L66-76 |
| `server/src/graphql/mutations/questionTranslation.ts` | L1-19 |
| `server/src/graphql/mutations/questionTranslation.ts` | L76-124 |
| `server/src/graphql/mutations/question.ts` | L14-64 |
| `server/src/graphql/mutations/surveyTranslation.ts` | L1-23 |
| `server/src/graphql/mutations/question.ts` | L64-86 |
| `server/src/graphql/mutations/questionTranslation.ts` | L19-76 |
| `server/src/graphql/mutations/question.ts` | L1-14 |
| `server/src/graphql/mutations/surveyTranslation.ts` | L23-67 |
| `server/src/graphql/mutations/block.ts` | L50-70 |
| `server/src/graphql/mutations/question.ts` | L207-255 |
| `server/src/graphql/mutations/question.ts` | L86-107 |
| `server/src/graphql/mutations/block.ts` | L70-94 |
| `server/src/graphql/mutations/survey.ts` | L62-84 |
| `server/src/graphql/mutations/survey.ts` | L1-23 |
| `server/src/graphql/mutations/block.ts` | L1-50 |
| `server/src/graphql/mutations/survey.ts` | L84-127 |
| `server/src/graphql/mutations/question.ts` | L151-207 |
| `server/src/graphql/mutations/question.ts` | L107-151 |
| `server/src/graphql/mutations/block.ts` | L132-175 |

</details>

---

Okay, I found the definition for `createChoiceListItemTranslation` in `server/src/graphql/mutations/choiceListItemTranslation.ts`.

Based on the code:

*   It's defined using `builder.mutationField('createChoiceListItemTranslation', ...)`.
*   It takes three top-level arguments:
    *   `choiceListItemId`: An integer ID for the item you're translating.
    *   `languageCode`: A string for the language (e.g., 'de' for German).
    *   `input`: An object containing the actual translation data.
*   The `input` object itself currently expects one field:
    *   `text`: A string containing the translated label.

So, your GraphQL mutation call to add a new German translation for a choice list item with ID `123` and the label "Ja" would look like this:

```graphql
mutation CreateGermanTranslation {
  createChoiceListItemTranslation(
    choiceListItemId: 123,  # Replace with the actual ID
    languageCode: "de",     # German language code
    input: {
      text: "Ja"            # The translated text
    }
  ) {
    # Specify the fields you want returned, e.g.,
    id
    language_code
    text
    choice_list_item {
      id
    }
  }
}
```

Remember to replace `123` with the actual `choiceListItemId` and `"Ja"` with the correct German translation for each item you need to add. You would execute one such mutation for each missing translation.

Does this structure make sense for adding your German translations?

---

_**User**_

ok, this is missing meanigfull descriptioon input: t.arg({ type: CreateChoiceListItemTranslationInput, required: true }),, can you provide it please

---

_**Assistant**_



---

You are absolutely right! The `input` argument in the `createChoiceListItemTranslation` mutation definition is missing a description. Good catch.

I will add a description to clarify that this argument holds the actual translation data.

Here is the proposed change for `server/src/graphql/mutations/choiceListItemTranslation.ts`:

---

```diff
        choiceListItemId: t.arg.int({ required: true, description: "The ID of the choice list item." }),
        languageCode: t.arg.string({ required: true, description: "The language code of the translation (e.g., 'en')." }),
-       input: t.arg({ type: CreateChoiceListItemTranslationInput, required: true }),
+       input: t.arg({ type: CreateChoiceListItemTranslationInput, required: true, description: "The translation data for the choice list item." }),
      },
      resolve: async (query, _root, args, ctx) => {
```

---

The description has been added to the `input` argument in `server/src/graphql/mutations/choiceListItemTranslation.ts`.

---

_**User**_

is this part ok and correct and consisten with nameing 

---

_**Assistant**_



---

You've spotted an important inconsistency, and the linter errors confirm it.

The code defining the GraphQL input types (`CreateChoiceListItemTranslationInput` and `UpdateChoiceListItemTranslationInput`) uses the field name `text`. However, the Prisma model for `ChoiceListItemTranslation` expects a different field name when creating or updating the database record. The linter errors indicate that `text` is not a known property for the Prisma operations.

Based on your earlier comment and common patterns in this project (like in `addChoiceListItem`), the field in the Prisma `ChoiceListItemTranslation` model is likely named `label`, not `text`.

To fix this and make the naming consistent between the GraphQL API layer and the database layer, I need to update the `resolve` functions to map the incoming `text` argument to the `label` field in the Prisma calls.

Here's the proposed change for `server/src/graphql/mutations/choiceListItemTranslation.ts`:

I will correct the field name used in the `create` operation.

---

```diff
              },
              language_code: languageCode,
-             text: text,
+             label: text,
            },
            ...query,
```

```diff
            },
            data: {
-             text: text,
+             label: text,
            },
            // Include fields based on the GraphQL query selection set
```

---

Now I will correct the field name used in the `update` operation.

---



---

It seems the previous edit already corrected the `update` operation as well.

These changes ensure that the `text` value received from the GraphQL mutation input is correctly saved to the `label` field in your `ChoiceListItemTranslation` database table, resolving the linter errors and the inconsistency.

---

_**User**_

are we good now ? can you check other mutations if they have some inconsisneris or lintern errors or missing desritpions for parameters

---

_**Assistant**_



---

